import{i as Y,B as ee}from"./theme.BWMAtRbQ.js";import{_ as te}from"./VRadios.vue_vue_type_script_setup_true_lang._q4jGPfl.js";/* empty css                                                 */import{a6 as M,ae as se,d as N,af as O,o as p,j as h,r as B,$ as re,ag as Z,y as f,H as I,t as j,l as k,f as ae,E as D,a9 as L,a7 as ne,c as w,p as g,D as b,n as oe,Z as T,a as ie,b as F}from"./framework.BYKI4aRn.js";import{T as le}from"./Toast.CHThUU3y.js";import{_ as ce}from"./VButton.vue_vue_type_script_setup_true_lang.CSGJQnck.js";import{_ as W}from"./VInput.vue_vue_type_script_setup_true_lang.Cb8agf_h.js";import"./VListbox.vue_vue_type_script_setup_true_lang.Dj4yH1jN.js";import"./sf7.2qo0E3J-.js";const H=Symbol("VFormItemLabel"),J=Symbol("VForm");/**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 */const ue=(s,e)=>{const r=e.split(".");let t=s;for(const a of r)t=t==null?void 0:t[a];return t},de=(s,e,r)=>{const t=e.split("."),a=t.slice(0,-1),c=t[t.length-1];let i=s;for(const l of a)if(i=i[l],!i)return;i[c]=r},me=(s,e)=>{const r=e.split("."),t=r.slice(0,-1),a=r[r.length-1];let c=s;for(const i of t)if(c=c[i],!c)return;delete c[a]},fe=(s,e)=>{let r=s,t={};const[a,c]=Array.isArray(e.action)?e.action:[e.action],i=M({value:r(),reset(l){l&&(r=l),i.value=r()},loading:!1,async submit(){i.loading=!0;try{const l=se(i.value);Object.entries(i.items).filter(([,u])=>!u._visible).forEach(([u])=>me(l,u));const y=await i.validate();if(typeof y=="string")throw c==null||c(y),new DOMException("","AbortError");return await(a==null?void 0:a(l))}finally{i.loading=!1}},_h:l=>{var _;let y=l.split("."),u=t;for(;y.length;){const m=y.shift();if(u=((_=u[m])==null?void 0:_.children)??u[m],!u)return{}}return u},i:l=>l,async validate(){var _;const l=Object.entries(i.items).filter(([,m])=>m._visible).map(([m,$])=>[m,$.validate()]),y=await Promise.all(l.map(([,m])=>m)),u=y.findIndex(m=>typeof m=="string");if(u!==-1){const m=l[u][0];return(_=i.items[m])==null||_.focus(),y[u]}},items:{},hierarchy:l=>void(t=l)});return i},P={inc:Y("FORM"),getter:ue,setter:de,init:fe},pe=N({__name:"VForm",props:{form:{}},setup(s){const e=s;return O(J,e.form),(r,t)=>(p(),h("form",{class:"VForm",onSubmit:t[0]||(t[0]=re(a=>void e.form.submit(),["prevent"]))},[B(r.$slots,"default")],32))}}),ye=s=>{if(typeof s=="object"&&!Array.isArray(s))return s;const[e,r]=[Array.isArray(s)?s[0]:s,Array.isArray(s)?s[1]:void 0],t={type:e.endsWith("!")?e.slice(0,-1):e};return e.endsWith("!")&&(t.required=!0),r&&(t.config=r),t},he={fieldname:"字段"},d={default:"{{s}} 不匹配格式",required:"请输入 {{s}}",checked:"请先检阅 {{s}}",enum:"{{s}} 不在选项范围内",any:"{{s}} 必须为任意类型",string:"{{s}} 必须为字符类型",array:"{{s}} 必须为列表类型",number:"{{s}} 必须为数值类型",boolean:"{{s}} 必须为布尔类型",email:"{{s}} 不是有效的邮箱地址",type:"{{s}} 不匹配格式",ranges:{string:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"},number:{len:"{{s}} 必须等于 {{a}}",min:"{{s}} 至少为 {{a}}",max:"{{s}} 至多为 {{a}}",range:"{{s}} 的值必须介于 {{a}} - {{b}}"},array:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"}}},A=/\{\{a\}\}/,q=/\{\{b\}\}/,z=/\{\{s\}\}/,S=(s,e,r)=>{if(typeof e=="number"&&s!==e)return d.ranges[r].len.replace(A,""+e);if(Array.isArray(e)){const[t,a]=e;if(typeof t=="number"&&s<t)return t===a?d.ranges[r].len.replace(A,""+t):typeof a=="number"?d.ranges[r].range.replace(A,""+t).replace(q,""+a):d.ranges[r].min.replace(A,""+t);if(typeof a=="number"&&s>a)return t===a?d.ranges[r].len.replace(A,""+t):typeof t=="number"?d.ranges[r].range.replace(A,""+t).replace(q,""+a):d.ranges[r].max.replace(A,""+a)}},v=new Map;v.set("any",{type:()=>{}});v.set("string",{type:(s,e)=>{if(typeof s!="string")return d.string;if(typeof e=="number"||Array.isArray(e))return S(s.length,e,"string");if(e instanceof RegExp&&!e.test(s))return d.default},testEmpty:s=>s===""});v.set("number",{type:(s,e)=>{if(typeof s!="number"||!Number.isFinite(s)||Number.isNaN(s))return d.number;if(typeof e=="number"||Array.isArray(e))return S(s,e,"number")}});v.set("array",{type:(s,e)=>{if(!Array.isArray(s))return d.array;if(typeof e=="number"||Array.isArray(e))return S(s.length,e,"array")}});v.set("enum",{type:(s,e)=>{if(!(Array.isArray(e)?e:[e]).some(t=>Object.is(s,t)))return d.enum}});v.set("boolean",{type:s=>{if(typeof s!="boolean")return d.boolean}});v.set("checked",{type:s=>{if(s!==!0)return d.checked}});v.set("type",{type:(s,e)=>{if(e&&s&&!(s instanceof e))return d.default}});const _e=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;v.set("email",{extends:"string",type(s){if(!_e.test(s))return d.email}});const be=s=>s==null,U=(s,e,r=he.fieldname)=>{var l,y,u;const t=ye(e),a=t.type&&v.get(t.type);if(a!=null&&a.extends){const _=U(s,{...t,type:a.extends},r);if(_)return _}const c=be(s)||((l=a==null?void 0:a.testEmpty)==null?void 0:l.call(a,s,t.config));if(!t.required&&c)return;if(t.required&&c)return t.message??d.required.replace(z,r);const i=(y=a==null?void 0:a.type)==null?void 0:y.call(a,s,t.config);return typeof i=="string"?t.message??i.replace(z,r):(u=t.validator)==null?void 0:u.call(t,s)},ge=["for"],ve={key:0,class:"clr-main"},G=N({__name:"VFormLabel",setup(s){const e=Z(H)||{id:"",asterisk:!1},r=()=>{var t;return(t=document.getElementById(e.id))==null?void 0:t.focus()};return(t,a)=>f(e).id&&f(e).label?(p(),h("label",{key:0,for:f(e).id,tabindex:"-1",onFocus:r},[I(j(f(e).label)+" ",1),f(e).asterisk?(p(),h("span",ve,"*")):k("",!0)],40,ge)):k("",!0)}}),we=N(s=>{if(!s.forwardRef)return()=>s.render();const e=ae();return D(()=>{s.forwardRef(e)}),()=>{var a;const r=s.render(),t=Array.isArray(r)?r[0]:r;return(a=t.props)!=null&&a.ref&&console.warn("[StrawberryFarm] refs are forwarded."),L(t,{ref:e})}},{name:"RenderFunction",props:["forwardRef","render"]}),Ae={class:"VFormItemTitle"},ke={key:0,class:"f3"},$e={key:1},xe={key:2,class:"[B] f2 tone:reimu Alert"},Ee=g("i-feather",{i:"x-octagon"},null,-1),Fe={class:"px-1"},R=N({__name:"VFormItem",props:{name:{},label:{},rules:{},visible:{type:Boolean,default:void 0}},setup(s){const e=s,r=ne(),t=Z(J),a=P.inc(),c=w(()=>e.name?t._h(e.name):void 0),i=w(()=>{var n;return f((n=c.value)==null?void 0:n.label)??e.label}),l=w(()=>{var n;return[...f((n=c.value)==null?void 0:n.rules)??[],...e.rules??[]]}),y=w(()=>{var n;return!!((n=l.value)!=null&&n.some(o=>typeof o=="string"?o.endsWith("!"):Array.isArray(o)?o[0].endsWith("!"):o.required))}),u=w(()=>{var n,o;return typeof e.visible=="boolean"?e.visible:((o=(n=c.value)==null?void 0:n.visible)==null?void 0:o.value)!==!1});O(H,M({id:a,label:i,asterisk:y}));const _=w({get(){if(e.name)return P.getter(t.value,e.name)},set(n){e.name&&(P.setter(t.value,e.name,n),K().then(o=>C.message=o))}}),m=async()=>{const n=_.value,o=l.value,V=i.value;if(o.length){let E;for(const X of o)if(E=await U(n,X,V),typeof E=="string")return E}},$=ee(),K=async()=>{$();const n=$(new AbortController).signal,o=await m();return n.aborted?new Promise(()=>1/0):o},C=M({focus:()=>{var n,o;return(o=(n=document.getElementById(a))==null?void 0:n.focus)==null?void 0:o.call(n)},validate:()=>($(),m()),_visible:u,message:void 0});D(n=>{const o=e.name;!o||!c.value||(t.items[o]=C,n(()=>delete t.items[o]))});const x=w(()=>C.message),Q=()=>{var n,o,V;return L(((n=r.default)==null?void 0:n.call(r)[0])??((V=(o=c.value)==null?void 0:o.render)==null?void 0:V.call(o))??T(W),{id:a,modelValue:_.value,"onUpdate:modelValue":E=>{_.value=E}})};return(n,o)=>n.name&&u.value?(p(),h("div",{key:0,class:oe(["VFormItem",{invalid:typeof x.value=="string"}])},[g("div",Ae,[B(n.$slots,"title",{},()=>[b(G)])]),b(f(we),{render:Q}),n.$slots.extra?(p(),h("div",ke,[B(n.$slots,"extra")])):k("",!0),n.$slots.alert?(p(),h("div",$e,[x.value?B(n.$slots,"alert",{key:0,message:x.value}):k("",!0)])):x.value?(p(),h("div",xe,[Ee,g("div",Fe,j(x.value),1)])):k("",!0)],2)):k("",!0)}}),Re={class:"[B] gap-1"},Ne=g("i-feather",{i:"arrow-right-circle"},null,-1),Ve={class:"[A]"},Be={class:"[B] gap-1"},Ie={key:0,i:"x",class:"clr-main tone:reimu"},Pe={key:1,i:"check",class:"clr-1"},Ce={class:"[B] gap-1"},Me={key:0,i:"x",class:"clr-main tone:reimu"},Se={key:1,i:"check",class:"clr-1"},qe={class:"[B] gap-1"},ze={key:0,i:"x",class:"clr-main tone:reimu"},Oe={key:1,i:"check",class:"clr-1"},Ze=g("i-feather",{i:"send"},null,-1),Qe=N({__name:"FormSignup",setup(s){const e=P.init(()=>({name:"霧雨魔理沙",password:"",repeatPassword:"",phoneNumber:"",dateRange:[new Date,new Date],chara:{name:"",weapon:"",shot:"",spellCard:""},charas:[]}),{action:t=>{le.success(JSON.stringify(t,null,2))}});e.hierarchy({name:{label:"Name",rules:[{type:"string",required:!0,config:[3,10]}]},password:{label:"Password",rules:[{validator(t){if(t.includes(" ")||t.length<6||t.length>12||t==="123456")return""}}]},dateRange:{},phoneNumber:{label:"Phone"},repeatPassword:{label:"Repeat Password",rules:[{validator(t){if(t!==e.value.password)return"Passwords are not equal"}}]},chara:{children:{name:{label:"Character",render(){return T(te,{options:["博麗霊夢","霧雨魔理沙"]})}},shot:{},spellCard:{},weapon:{}}},charaDel:{},charas:{init(){return{name:"",shot:"",spellCard:"",weapon:""}},children:{children:{name:{},shot:{},spellCard:{},weapon:{}}}}});const r=e.value;return e.items.name,e.items["dateRange.0"],e.items["charas.0.name"],(t,a)=>(p(),ie(pe,{form:f(e)},{default:F(()=>[b(R,{name:f(e).i("name")},{title:F(()=>[g("div",Re,[b(G),Ne])]),_:1},8,["name"]),b(R,{name:f(e).i("password")},{extra:F(()=>[g("div",Ve,[g("div",Be,[f(r).password.includes(" ")?(p(),h("i-feather",Ie)):(p(),h("i-feather",Pe)),I(" Password cannot contain spaces. ")]),g("div",Ce,[f(r).password.length<6||f(r).password.length>12?(p(),h("i-feather",Me)):(p(),h("i-feather",Se)),I(" Password should between 6 - 12 characters. ")]),g("div",qe,[f(r).password==="123456"?(p(),h("i-feather",ze)):(p(),h("i-feather",Oe)),I(" Password cannot be 123456 because that's the admin's password. ")])])]),_:1},8,["name"]),b(R,{name:"repeatPassword"}),b(R,{name:"phoneNumber"},{default:F(()=>[b(W,{placehholder:"666",clearable:""})]),_:1}),b(R,{name:"chara.name"}),b(ce,{type:"submit",class:"mat:air"},{prefix:F(()=>[Ze]),_:1})]),_:1},8,["form"]))}});export{Qe as default};
