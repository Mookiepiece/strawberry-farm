import{a as I}from"./misc.C9Tk6PVQ.js";import{d as q,z as L,A as K,a8 as O,a7 as Z,f as k,c as t,G as ee,a4 as U,p as le,o as d,i as h,r as E,af as M,ag as F,F as z,j as G,a as W,b as $,k as R,a0 as ae,a6 as oe,I as H,t as P,x as j,m as u,C as _,l as S}from"./framework.IAuM8QuA.js";import{e as te}from"./theme.DZqSg4PV.js";const J=Symbol("VTree"),B=new WeakMap,re=["aria-expanded","aria-busy","aria-selected","tabindex","data-level"],se={key:0,role:"group"},ne=q({__name:"VTreeNode",props:L({level:{default:0}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(T){const o=K(T,"modelValue"),p=T;O();const a=Z(J);if(!a)throw new Error;const i=k(),V=t(()=>a.current===o.value.value);ee(()=>{var l;V.value&&((l=i.value)==null||l.focus())});const v=(...l)=>{const r=[];return I(C=>r.push(C),...l),r},m=l=>!a.connected||!l.children?t(()=>({mixed:!1,unclear:!1,selected:Array.isArray(a.model)?a.model.includes(l.value):a.model===l.value})):(B.get(l)||B.set(l,t(()=>{let r=!1,C=!1,x=!1;return Array.isArray(l.children)?(x=l.children.some(w=>m(w).value.selected),C=x&&l.children.some(w=>!m(w).value.selected)):r=!0,{unclear:r,selected:x,mixed:C}})),B.get(l)),y=m(o.value),n=t(()=>y.value.selected),e=t(()=>y.value.mixed),f=t(()=>y.value.unclear),s=()=>{if(a.connected){if(f.value)return;if(!n.value||e.value){const l=v(o.value);Array.isArray(a.model)&&(l.filter(r=>!r.children).forEach(({value:r})=>{a.model.includes(r)||a.model.push(r),console.log(a.model)}),a.model=a.model)}else{const l=v(o.value);Array.isArray(a.model)&&(l.filter(r=>!r.children).forEach(({value:r})=>{a.model.includes(r)&&a.model.splice(a.model.indexOf(r),1)}),a.model=a.model)}}else{const l=o.value.value;Array.isArray(a.model)?(a.model.includes(l)?a.model.splice(a.model.indexOf(l),1):a.model.push(l),a.model=a.model):a.model=l}},c=t({get(){return!!o.value.open},set(l){o.value.open=l}}),g=t(()=>!!(Array.isArray(o.value.children)?o.value.children.length:o.value.children)),b=k(!1),A=te(async()=>{var l;try{b.value=!0;const r=o;r.value.children=await((l=a.load)==null?void 0:l.call(a,r.value))}finally{b.value=!1}}),Q=async()=>{c.value=!0,o.value.children===!0&&await A()},X=l=>{switch(l.key){case"ArrowDown":a.nav(1);break;case"ArrowUp":a.nav(-1);break;case"ArrowLeft":c.value=!1;break;case"ArrowRight":Q();break;case"Enter":case" ":s();break}},Y=U({value:t(()=>o.value.value),label:t(()=>o.value.label),meta:t(()=>o.value.meta),disabled:t(()=>o.value.disabled),open:t({get:()=>o.value.open,set(l){o.value.open=l,o.value=o.value}}),children:t(()=>o.value.children),current:V,selected:t({get:()=>n.value,set(l){l!==n.value&&s()}}),mixed:e,unclear:f,loading:b,level:t(()=>p.level)});return(l,r)=>{const C=le("VTreeNode",!0);return d(),h("div",{ref_key:"el",ref:i,role:"treeitem","aria-expanded":g.value?c.value:void 0,"aria-busy":b.value,"aria-selected":n.value,onKeydown:ae(X,["self","exact"]),tabindex:V.value?"0":"-1","data-level":l.level},[E(l.$slots,"default",M(F({model:Y}))),c.value&&Array.isArray(o.value.children)&&o.value.children.length?(d(),h("div",se,[(d(!0),h(z,null,G(o.value.children,(x,w)=>(d(),W(C,{modelValue:o.value.children[w],"onUpdate:modelValue":D=>o.value.children[w]=D,level:l.level+1,key:x.value},{default:$(D=>[E(l.$slots,"default",M(F(D)))]),_:2},1032,["modelValue","onUpdate:modelValue","level"]))),128))])):R("",!0)],40,re)}}}),N=q({__name:"VTree",props:L({connected:{type:Boolean},tree:{default:()=>[]},load:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(T,{expose:o}){const p=K(T,"modelValue"),a=T;O();const i=t(()=>U(a.tree)),V=(...s)=>{const c=[];return I(g=>c.push(g),...s),c},v=t(()=>V(...i.value)),m=k(null),y=t({get(){return v.value.some(s=>s.value===m.value)?m.value:v.value[0].value},set(s){m.value=s}}),n=s=>{const c=v.value[v.value.findIndex(({value:g})=>g===y.value)+s];c&&(y.value=c.value)};oe(J,U({model:t({get(){return p.value},set(s){p.value=s}}),tree:i,connected:t(()=>a.connected),load:t(()=>a.load),current:y,nav:n}));const e=k(),f=()=>{var s,c;return(c=(s=e.value)==null?void 0:s.querySelector('[role="treeitem"][tabindex="0"]'))==null?void 0:c.focus()};return o({el:e}),(s,c)=>(d(),h("div",{ref_key:"el",ref:e,role:"tree",class:"VTree",tabindex:"-1",onFocus:f},[(d(!0),h(z,null,G(i.value,(g,b)=>(d(),W(ne,{key:g.value,modelValue:i.value[b],"onUpdate:modelValue":A=>i.value[b]=A},{default:$(A=>[E(s.$slots,"default",M(F(A)),()=>[H(P(A.model.label??A.model.value),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))],544))}}),ce={class:"[A] gap-2"},ue=["onClick"],de=["i"],ie={key:1,style:{width:"1em","aspect-ratio":"1"}},ve=["onClick","i"],me=["onClick","i"],fe=["onClick"],he=["i"],pe=["onClick","i"],Ve=["onClick"],ye=["i"],Ae=q({__name:"Tree",setup(T){const o=()=>[{value:"Projects",children:[{value:"Project-1"},{value:"Project-2"},{value:"Project-3",children:[{value:"Project-3A"},{value:"Project-3B"},{value:"Project-3C"}]},{value:"Project-4"},{value:"Project-5",children:[{value:"Project-5A"},{value:"Project-5B"},{value:"Project-5C"}]}]},{value:"Reports"},{value:"Letters"}],p=o(),a=o(),i=k(null),V=k([]),v=k([]),m=k([]);return(y,n)=>(d(),h(z,null,[H(P(j(p))+" ",1),u("div",ce,[_(N,{class:"VTreeDemo",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),tree:j(p)},null,8,["modelValue","tree"]),_(N,{class:"VTreeDemo2",modelValue:V.value,"onUpdate:modelValue":n[1]||(n[1]=e=>V.value=e),tree:j(p)},{default:$(({model:e})=>[u("div",{class:"VTreeDemo2A",style:S({"--level":e.level})},[u("div",{class:"VTreeDemo2B",onClick:f=>e.open=!e.open},[e.children?(d(),h("i-feather",{key:0,i:e.open?"chevron-down":"chevron-right"},null,8,de)):(d(),h("div",ie)),u("div",null,P(e.label??e.value),1)],8,ue),u("i-feather",{class:"VTreeDemo2C",onClick:f=>e.selected=!e.selected,i:e.selected?"check-circle":"circle"},null,8,ve)],4)]),_:1},8,["modelValue","tree"]),_(N,{class:"VTreeDemo3",modelValue:v.value,"onUpdate:modelValue":n[2]||(n[2]=e=>v.value=e),tree:j(a)},{default:$(({model:e})=>[u("div",{class:"VTreeDemo3A",style:S({"--level":e.level})},[e.children?(d(),h("i-feather",{key:0,class:"VTreeDemo3B",onClick:f=>e.open=!e.open,i:e.open?"chevron-down":"chevron-right"},null,8,me)):R("",!0),u("div",{class:"VTreeDemo3C",onClick:f=>e.selected=!e.selected},[u("div",null,P(e.label??e.value),1),u("i-feather",{i:e.selected?"check-circle":"circle"},null,8,he)],8,fe)],4)]),_:1},8,["modelValue","tree"]),_(N,{class:"VTreeDemo3",modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=e=>m.value=e),tree:j(a),connected:""},{default:$(({model:e})=>[u("div",{class:"VTreeDemo3A",style:S({"--level":e.level})},[e.children?(d(),h("i-feather",{key:0,class:"VTreeDemo3B",onClick:f=>e.open=!e.open,i:e.open?"chevron-down":"chevron-right"},null,8,pe)):R("",!0),u("div",{class:"VTreeDemo3C",onClick:f=>e.selected=!e.selected},[u("div",null,P(e.label??e.value),1),u("i-feather",{i:e.mixed?"square":e.selected?"check-circle":"circle"},null,8,ye)],8,Ve)],4)]),_:1},8,["modelValue","tree"])])],64))}});export{Ae as default};
