import{f as $,v as T,G as w,d as N,z as E,A as K,c as B,o as v,i as c,m as y,r as C,k as b,n as R,t as j,aa as z,a0 as D,a1 as f,x as V,a as F,ac as W,ad as q,C as G,T as H,F as O}from"./framework.IkYOgTiJ.js";import{o as U,a as J,f as P,l as h}from"./theme.i3CGoA02.js";import{_ as L}from"./VListbox.vue_vue_type_script_setup_true_lang.hwwb5ZUb.js";const Q=n=>n.flatMap(a=>a&&typeof a=="object"&&"options"in a?a.options:a).map(a=>a&&typeof a=="object"&&"value"in a?a:{value:a,label:""+a}),X=(n,a)=>{const l=Array.isArray(n)?n:[n];return U(document).pointerdown(p=>{l.every(s=>(s==null?void 0:s.contains(p.target))===!1)&&a()})},Y=({reference:n,popper:a,configs:l,plugins:p=[]})=>{const s=$(!1),i=$(!1);return T(()=>[a.value,s.value],([u,d],m,k)=>{if(d&&u){const r=n.value;k(h.auto(r,()=>{h(r,u,l,...p),i.value=!0}))}}),w(u=>{l!=null&&l.trap&&(!s.value||!i.value||!a.value||u(J(a.value)))}),w(u=>{if(!(l!=null&&l.clickAway)||!a.value||!n.value||!s.value)return;const d=n.value,m=a.value;u(X([m,d],()=>{s.value=!1,console.log(1)}))}),w(()=>{if(!i.value||!a.value)return;if(!(l!=null&&l.animated)&&!s.value){i.value=!1;return}const u=a.value.querySelector(".VPopperBody");u&&(s.value?P.cssTransition(u,"v-enter"):P.cssTransition(u,"v-leave",{done(){i.value=!1}}))}),{open:s,visible:i}},Z=["aria-expanded"],_={key:0,class:"VInputPrefix"},g={key:1,class:"VInputSuffix"},ee={class:"VPopperBody"},se=N({__name:"VSelect",props:E({multi:{type:Boolean},options:{},disabled:{type:Boolean},placeholder:{},clearable:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:a}){const l=K(n,"modelValue"),p=n,s=$(),i=$(),u=h.plugins.flip(()=>({limit:200})),d=e=>{let t=e.$pop.style.getPropertyValue("width");t.endsWith("px")||(t=""),t=Number(t.slice(0,-2));const o=e.$ref.getBoundingClientRect().width;if(t!==o){e.$pop.style.setProperty("width",o+"px");const M=e.$pop.getBoundingClientRect();return{...e,pop:M}}return e},m=e=>{const{$pop:t,dir:o}=e;return t.setAttribute("data-pop-dir",o),e},k=e=>{const{$pop:t,map:o}=e;return t.style.setProperty("--max-height",Math.floor(o.height-20)+"px"),{...e,pop:t.getBoundingClientRect()}},{open:r,visible:A}=Y({popper:i,reference:s,configs:{offset:5,animated:!0,trap:!0,clickAway:!0},plugins:[d,u,m,k]}),S=()=>{var e;l.value=null,(e=s.value)==null||e.focus()},x=B({get(){return l.value},set(e){r.value=!1,l.value=e}}),I=B(()=>{var e;return p.options?(e=Q(p.options).find(t=>t.value===l.value))==null?void 0:e.label:l.value});return a({el:s}),(e,t)=>(v(),c(O,null,[y("div",z({class:"VInput VSelect",tabindex:"0",ref_key:"reference",ref:s,onClick:t[0]||(t[0]=D(o=>r.value=!V(r),["self"])),onKeydown:[t[1]||(t[1]=f(o=>r.value=!0,["space"])),t[2]||(t[2]=f(o=>r.value=!0,["enter"])),t[3]||(t[3]=f(o=>r.value=!0,["up"])),t[4]||(t[4]=f(o=>r.value=!0,["down"]))],role:"button","aria-haspopup":"true","aria-expanded":V(r)},e.$attrs),[e.$slots.prefix?(v(),c("div",_,[C(e.$slots,"prefix")])):b("",!0),e.$slots.suffix?(v(),c("div",g,[C(e.$slots,"suffix")])):b("",!0),p.clearable&&l.value!=null?(v(),c("i-feather",{key:2,i:"x",class:"VInputEraser",tabindex:"-1",onClick:S,"aria-hidden":"true"})):b("",!0),y("div",{class:R(["VInputTrunk",l.value==null?"VInputTrunkPlaceholder":void 0])},j(I.value??p.placeholder),3)],16,Z),(v(),F(H,{to:"body"},[W(y("div",{ref_key:"popper",ref:i,class:"VPositioner",onKeydown:t[6]||(t[6]=f(o=>r.value=!1,["esc"])),style:{position:"fixed",top:"0",left:"0"}},[y("div",ee,[G(L,{"power-pointer":"",modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=o=>x.value=o),options:e.options,class:"VSelectPicker"},null,8,["modelValue","options"])])],544),[[q,V(r)||V(A)]])]))],64))}});export{se as _};
