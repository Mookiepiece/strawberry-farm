import{i as Q,B as X}from"./theme.DZqSg4PV.js";import{a4 as M,a5 as Y,d as P,a6 as S,o as p,i as y,r as R,a0 as ee,a7 as Z,x as f,I as B,t as L,k,a8 as te,c as w,G as se,m as g,C as b,n as re,a9 as ae,$ as j,a as ne,b as F}from"./framework.IAuM8QuA.js";import{T as oe}from"./Toast.Bc0X4Fwb.js";import{_ as ie}from"./VButton.vue_vue_type_script_setup_true_lang.D1ACYgAD.js";import{_ as D}from"./VInput.vue_vue_type_script_setup_true_lang.DMfnOFnG.js";import{R as le}from"./VListbox.vue_vue_type_script_setup_true_lang.B1_CvdMk.js";import{_ as ce}from"./VRadioGroup.vue_vue_type_script_setup_true_lang.B2obXzJG.js";import"./sf7.2qo0E3J-.js";import"./misc.C9Tk6PVQ.js";const T=Symbol("VFormItemLabel"),W=Symbol("VForm");/**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 */const ue=(s,e)=>{const r=e.split(".");let t=s;for(const a of r)t=t==null?void 0:t[a];return t},me=(s,e,r)=>{const t=e.split("."),a=t.slice(0,-1),c=t[t.length-1];let i=s;for(const l of a)if(i=i[l],!i)return;i[c]=r},de=(s,e)=>{const r=e.split("."),t=r.slice(0,-1),a=r[r.length-1];let c=s;for(const i of t)if(c=c[i],!c)return;delete c[a]},fe=(s,e)=>{let r=s,t={};const[a,c]=Array.isArray(e.action)?e.action:[e.action],i=M({value:r(),reset(l){l&&(r=l),i.value=r()},loading:!1,async submit(){i.loading=!0;try{const l=Y(i.value);Object.entries(i.items).filter(([,u])=>!u._visible).forEach(([u])=>de(l,u));const h=await i.validate();if(typeof h=="string")throw c==null||c(h),new DOMException("","AbortError");return await(a==null?void 0:a(l))}finally{i.loading=!1}},_h:l=>{var _;let h=l.split("."),u=t;for(;h.length;){const d=h.shift();if(u=((_=u[d])==null?void 0:_.children)??u[d],!u)return{}}return u},i:l=>l,async validate(){var _;const l=Object.entries(i.items).filter(([,d])=>d._visible).map(([d,$])=>[d,$.validate()]),h=await Promise.all(l.map(([,d])=>d)),u=h.findIndex(d=>typeof d=="string");if(u!==-1){const d=l[u][0];return(_=i.items[d])==null||_.focus(),h[u]}},items:{},hierarchy:l=>void(t=l)});return i},I={inc:Q("FORM"),getter:ue,setter:me,init:fe},pe=P({__name:"VForm",props:{form:{}},setup(s){const e=s;return S(W,e.form),(r,t)=>(p(),y("form",{class:"VForm",onSubmit:t[0]||(t[0]=ee(a=>void e.form.submit(),["prevent"]))},[R(r.$slots,"default")],32))}}),he=s=>{if(typeof s=="object"&&!Array.isArray(s))return s;const[e,r]=[Array.isArray(s)?s[0]:s,Array.isArray(s)?s[1]:void 0],t={type:e.endsWith("!")?e.slice(0,-1):e};return e.endsWith("!")&&(t.required=!0),r&&(t.config=r),t},ye={fieldname:"字段"},m={default:"{{s}} 不匹配格式",required:"请输入 {{s}}",checked:"请先检阅 {{s}}",enum:"{{s}} 不在选项范围内",any:"{{s}} 必须为任意类型",string:"{{s}} 必须为字符类型",array:"{{s}} 必须为列表类型",number:"{{s}} 必须为数值类型",boolean:"{{s}} 必须为布尔类型",email:"{{s}} 不是有效的邮箱地址",type:"{{s}} 不匹配格式",ranges:{string:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"},number:{len:"{{s}} 必须等于 {{a}}",min:"{{s}} 至少为 {{a}}",max:"{{s}} 至多为 {{a}}",range:"{{s}} 的值必须介于 {{a}} - {{b}}"},array:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"}}},A=/\{\{a\}\}/,z=/\{\{b\}\}/,O=/\{\{s\}\}/,q=(s,e,r)=>{if(typeof e=="number"&&s!==e)return m.ranges[r].len.replace(A,""+e);if(Array.isArray(e)){const[t,a]=e;if(typeof t=="number"&&s<t)return t===a?m.ranges[r].len.replace(A,""+t):typeof a=="number"?m.ranges[r].range.replace(A,""+t).replace(z,""+a):m.ranges[r].min.replace(A,""+t);if(typeof a=="number"&&s>a)return t===a?m.ranges[r].len.replace(A,""+t):typeof t=="number"?m.ranges[r].range.replace(A,""+t).replace(z,""+a):m.ranges[r].max.replace(A,""+a)}},v=new Map;v.set("any",{type:()=>{}});v.set("string",{type:(s,e)=>{if(typeof s!="string")return m.string;if(typeof e=="number"||Array.isArray(e))return q(s.length,e,"string");if(e instanceof RegExp&&!e.test(s))return m.default},testEmpty:s=>s===""});v.set("number",{type:(s,e)=>{if(typeof s!="number"||!Number.isFinite(s)||Number.isNaN(s))return m.number;if(typeof e=="number"||Array.isArray(e))return q(s,e,"number")}});v.set("array",{type:(s,e)=>{if(!Array.isArray(s))return m.array;if(typeof e=="number"||Array.isArray(e))return q(s.length,e,"array")}});v.set("enum",{type:(s,e)=>{if(!(Array.isArray(e)?e:[e]).some(t=>Object.is(s,t)))return m.enum}});v.set("boolean",{type:s=>{if(typeof s!="boolean")return m.boolean}});v.set("checked",{type:s=>{if(s!==!0)return m.checked}});v.set("type",{type:(s,e)=>{if(e&&s&&!(s instanceof e))return m.default}});const _e=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;v.set("email",{extends:"string",type(s){if(!_e.test(s))return m.email}});const be=s=>s==null,G=(s,e,r=ye.fieldname)=>{var l,h,u;const t=he(e),a=t.type&&v.get(t.type);if(a!=null&&a.extends){const _=G(s,{...t,type:a.extends},r);if(_)return _}const c=be(s)||((l=a==null?void 0:a.testEmpty)==null?void 0:l.call(a,s,t.config));if(!t.required&&c)return;if(t.required&&c)return t.message??m.required.replace(O,r);const i=(h=a==null?void 0:a.type)==null?void 0:h.call(a,s,t.config);return typeof i=="string"?t.message??i.replace(O,r):(u=t.validator)==null?void 0:u.call(t,s)},ge=["for"],ve={key:0,class:"clr-main"},J=P({__name:"VFormLabel",setup(s){const e=Z(T)||{id:"",asterisk:!1},r=()=>{var t;return(t=document.getElementById(e.id))==null?void 0:t.focus()};return(t,a)=>f(e).id&&f(e).label?(p(),y("label",{key:0,for:f(e).id,tabindex:"-1",onFocus:r},[B(L(f(e).label)+" ",1),f(e).asterisk?(p(),y("span",ve,"*")):k("",!0)],40,ge)):k("",!0)}}),we={class:"VFormItemTitle"},Ae={key:0,class:"f3"},ke={key:1},$e={key:2,class:"[B] f2 tone:reimu Alert"},xe=g("i-feather",{i:"x-octagon"},null,-1),Ee={class:"px-1"},N=P({__name:"VFormItem",props:{name:{},label:{},rules:{},visible:{type:Boolean,default:void 0}},setup(s){const e=s,r=te(),t=Z(W),a=I.inc(),c=w(()=>e.name?t._h(e.name):void 0),i=w(()=>{var n;return f((n=c.value)==null?void 0:n.label)??e.label}),l=w(()=>{var n;return[...f((n=c.value)==null?void 0:n.rules)??[],...e.rules??[]]}),h=w(()=>{var n;return!!((n=l.value)!=null&&n.some(o=>typeof o=="string"?o.endsWith("!"):Array.isArray(o)?o[0].endsWith("!"):o.required))}),u=w(()=>{var n,o;return typeof e.visible=="boolean"?e.visible:((o=(n=c.value)==null?void 0:n.visible)==null?void 0:o.value)!==!1});S(T,M({id:a,label:i,asterisk:h}));const _=w({get(){if(e.name)return I.getter(t.value,e.name)},set(n){e.name&&(I.setter(t.value,e.name,n),U().then(o=>C.message=o))}}),d=async()=>{const n=_.value,o=l.value,V=i.value;if(o.length){let E;for(const K of o)if(E=await G(n,K,V),typeof E=="string")return E}},$=X(),U=async()=>{$();const n=$(new AbortController).signal,o=await d();return n.aborted?new Promise(()=>1/0):o},C=M({focus:()=>{var n,o;return(o=(n=document.getElementById(a))==null?void 0:n.focus)==null?void 0:o.call(n)},validate:()=>($(),d()),_visible:u,message:void 0});se(n=>{const o=e.name;!o||!c.value||(t.items[o]=C,n(()=>delete t.items[o]))});const x=w(()=>C.message),H=()=>{var n,o,V;return ae(((n=r.default)==null?void 0:n.call(r)[0])??((V=(o=c.value)==null?void 0:o.render)==null?void 0:V.call(o))??j(D),{id:a,modelValue:_.value,"onUpdate:modelValue":E=>{_.value=E}})};return(n,o)=>n.name&&u.value?(p(),y("div",{key:0,class:re(["VFormItem",{invalid:typeof x.value=="string"}])},[g("div",we,[R(n.$slots,"title",{},()=>[b(J)])]),b(f(le),{render:H}),n.$slots.extra?(p(),y("div",Ae,[R(n.$slots,"extra")])):k("",!0),n.$slots.alert?(p(),y("div",ke,[x.value?R(n.$slots,"alert",{key:0,message:x.value}):k("",!0)])):x.value?(p(),y("div",$e,[xe,g("div",Ee,L(x.value),1)])):k("",!0)],2)):k("",!0)}}),Fe={class:"[B] gap-1"},Ne=g("i-feather",{i:"arrow-right-circle"},null,-1),Ve={class:"[A]"},Re={class:"[B] gap-1"},Be={key:0,i:"x",class:"clr-main tone:reimu"},Ie={key:1,i:"check",class:"clr-1"},Pe={class:"[B] gap-1"},Ce={key:0,i:"x",class:"clr-main tone:reimu"},Me={key:1,i:"check",class:"clr-1"},qe={class:"[B] gap-1"},ze={key:0,i:"x",class:"clr-main tone:reimu"},Oe={key:1,i:"check",class:"clr-1"},Se=g("i-feather",{i:"send"},null,-1),Ke=P({__name:"FormSignup",setup(s){const e=I.init(()=>({name:"霧雨魔理沙",password:"",repeatPassword:"",phoneNumber:"",dateRange:[new Date,new Date],chara:{name:"",weapon:"",shot:"",spellCard:""},charas:[]}),{action:t=>{oe.success(JSON.stringify(t,null,2))}});e.hierarchy({name:{label:"Name",rules:[{type:"string",required:!0,config:[3,10]}]},password:{label:"Password",rules:[{validator(t){if(t.includes(" ")||t.length<6||t.length>12||t==="123456")return""}}]},dateRange:{},phoneNumber:{label:"Phone"},repeatPassword:{label:"Repeat Password",rules:[{validator(t){if(t!==e.value.password)return"Passwords are not equal"}}]},chara:{children:{name:{label:"Character",render(){return j(ce,{options:["博麗霊夢","霧雨魔理沙"]})}},shot:{},spellCard:{},weapon:{}}},charaDel:{},charas:{init(){return{name:"",shot:"",spellCard:"",weapon:""}},children:{children:{name:{},shot:{},spellCard:{},weapon:{}}}}});const r=e.value;return e.items.name,e.items["dateRange.0"],e.items["charas.0.name"],(t,a)=>(p(),ne(pe,{form:f(e)},{default:F(()=>[b(N,{name:f(e).i("name")},{title:F(()=>[g("div",Fe,[b(J),Ne])]),_:1},8,["name"]),b(N,{name:f(e).i("password")},{extra:F(()=>[g("div",Ve,[g("div",Re,[f(r).password.includes(" ")?(p(),y("i-feather",Be)):(p(),y("i-feather",Ie)),B(" Password cannot contain spaces. ")]),g("div",Pe,[f(r).password.length<6||f(r).password.length>12?(p(),y("i-feather",Ce)):(p(),y("i-feather",Me)),B(" Password should between 6 - 12 characters. ")]),g("div",qe,[f(r).password==="123456"?(p(),y("i-feather",ze)):(p(),y("i-feather",Oe)),B(" Password cannot be 123456 because that's the admin's password. ")])])]),_:1},8,["name"]),b(N,{name:"repeatPassword"}),b(N,{name:"phoneNumber"},{default:F(()=>[b(D,{placehholder:"666",clearable:""})]),_:1}),b(N,{name:"chara.name"},null,8,["name"]),b(ie,{type:"submit",class:"mat:air"},{prefix:F(()=>[Se]),_:1})]),_:1},8,["form"]))}});export{Ke as default};
