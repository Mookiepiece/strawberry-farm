import{d as q,A as L,B as z,a1 as I,af as Y,f as g,c as o,E as Z,a0 as S,q as ee,o as i,j as p,r as U,ab as le,ac as ae,F,k as K,a as O,b as _,ag as H,l as M,a2 as te,ae as oe,H as W,t as j,y as P,p as u,D as $,m as N}from"./framework.qiMOmzvi.js";import{k as re}from"./theme.CGULKHWn.js";const R=(V,...t)=>{t.forEach(d=>{V(d),Array.isArray(d.children)&&R(V,...d.children)})},G=Symbol("VTree"),B=new WeakMap,se=["aria-expanded","aria-busy","aria-selected","tabindex","data-level"],ne={key:0,role:"group"},ce=q({__name:"VTreeNode",props:L({level:{default:0}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(V){const t=z(V,"modelValue"),d=V;I();const a=Y(G);if(!a)throw new Error;const v=g(),y=o(()=>a.current===t.value.value);Z(()=>{var l;y.value&&((l=v.value)==null||l.focus())});const m=(...l)=>{const r=[];return R(w=>r.push(w),...l),r},f=l=>!a.connected||!l.children?o(()=>({mixed:!1,unclear:!1,selected:Array.isArray(a.model)?a.model.includes(l.value):a.model===l.value})):(B.get(l)||B.set(l,o(()=>{let r=!1,w=!1,x=!1;return Array.isArray(l.children)?(x=l.children.some(C=>f(C).value.selected),w=x&&l.children.some(C=>!f(C).value.selected)):r=!0,{unclear:r,selected:x,mixed:w}})),B.get(l)),k=f(t.value),n=o(()=>k.value.selected),e=o(()=>k.value.mixed),h=o(()=>k.value.unclear),s=()=>{if(a.connected){if(h.value)return;if(!n.value||e.value){const l=m(t.value);Array.isArray(a.model)&&(l.filter(r=>!r.children).forEach(({value:r})=>{a.model.includes(r)||a.model.push(r),console.log(a.model)}),a.model=a.model)}else{const l=m(t.value);Array.isArray(a.model)&&(l.filter(r=>!r.children).forEach(({value:r})=>{a.model.includes(r)&&a.model.splice(a.model.indexOf(r),1)}),a.model=a.model)}}else{const l=t.value.value;Array.isArray(a.model)?(a.model.includes(l)?a.model.splice(a.model.indexOf(l),1):a.model.push(l),a.model=a.model):a.model=l}},c=o({get(){return!!t.value.open},set(l){t.value.open=l}}),A=o(()=>!!(Array.isArray(t.value.children)?t.value.children.length:t.value.children)),b=g(!1),T=re(async()=>{var l;try{b.value=!0;const r=t;r.value.children=await((l=a.load)==null?void 0:l.call(a,r.value))}finally{b.value=!1}}),J=async()=>{c.value=!0,t.value.children===!0&&await T()},Q=l=>{switch(l.key){case"ArrowDown":a.nav(1);break;case"ArrowUp":a.nav(-1);break;case"ArrowLeft":c.value=!1;break;case"ArrowRight":J();break;case"Enter":case" ":s();break}},X=S({value:o(()=>t.value.value),label:o(()=>t.value.label),meta:o(()=>t.value.meta),disabled:o(()=>t.value.disabled),open:o({get:()=>t.value.open,set(l){t.value.open=l,t.value=t.value}}),children:o(()=>t.value.children),current:y,selected:o({get:()=>n.value,set(l){l!==n.value&&s()}}),mixed:e,unclear:h,loading:b,level:o(()=>d.level)});return(l,r)=>{const w=ee("VTreeNode",!0);return i(),p("div",{ref_key:"el",ref:v,role:"treeitem","aria-expanded":A.value?c.value:void 0,"aria-busy":b.value,"aria-selected":n.value,onKeydown:te(Q,["self","exact"]),tabindex:y.value?"0":"-1","data-level":l.level},[U(l.$slots,"default",le(ae({model:X}))),c.value&&Array.isArray(t.value.children)&&t.value.children.length?(i(),p("div",ne,[(i(!0),p(F,null,K(t.value.children,(x,C)=>(i(),O(w,{modelValue:t.value.children[C],"onUpdate:modelValue":D=>t.value.children[C]=D,level:l.level+1,key:x.value},{default:_(D=>[U(l.$slots,"default",H({ref_for:!0},D))]),_:2},1032,["modelValue","onUpdate:modelValue","level"]))),128))])):M("",!0)],40,se)}}}),E=q({__name:"VTree",props:L({connected:{type:Boolean},tree:{default:()=>[]},load:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(V,{expose:t}){const d=z(V,"modelValue"),a=V;I();const v=o(()=>S(a.tree)),y=(...s)=>{const c=[];return R(A=>c.push(A),...s),c},m=o(()=>y(...v.value)),f=g(null),k=o({get(){return m.value.some(s=>s.value===f.value)?f.value:m.value[0].value},set(s){f.value=s}}),n=s=>{const c=m.value[m.value.findIndex(({value:A})=>A===k.value)+s];c&&(k.value=c.value)};oe(G,S({model:o({get(){return d.value},set(s){d.value=s}}),tree:v,connected:o(()=>a.connected),load:o(()=>a.load),current:k,nav:n}));const e=g(),h=()=>{var s,c;return(c=(s=e.value)==null?void 0:s.querySelector('[role="treeitem"][tabindex="0"]'))==null?void 0:c.focus()};return t({el:e}),(s,c)=>(i(),p("div",{ref_key:"el",ref:e,role:"tree",class:"VTree",tabindex:"-1",onFocus:h},[(i(!0),p(F,null,K(v.value,(A,b)=>(i(),O(ce,{key:A.value,modelValue:v.value[b],"onUpdate:modelValue":T=>v.value[b]=T},{default:_(T=>[U(s.$slots,"default",H({ref_for:!0},T),()=>[W(j(T.model.label??T.model.value),1)])]),_:2},1032,["modelValue","onUpdate:modelValue"]))),128))],544))}}),ue={class:"[A] gap-2"},de=["onClick"],ie=["i"],ve={key:1,style:{width:"1em","aspect-ratio":"1"}},me=["onClick","i"],fe=["onClick","i"],he=["onClick"],pe=["i"],Ve=["onClick","i"],ye=["onClick"],ke=["i"],be=q({__name:"Tree",setup(V){const t=()=>[{value:"Projects",children:[{value:"Project-1"},{value:"Project-2"},{value:"Project-3",children:[{value:"Project-3A"},{value:"Project-3B"},{value:"Project-3C"}]},{value:"Project-4"},{value:"Project-5",children:[{value:"Project-5A"},{value:"Project-5B"},{value:"Project-5C"}]}]},{value:"Reports"},{value:"Letters"}],d=t(),a=t(),v=g(null),y=g([]),m=g([]),f=g([]);return(k,n)=>(i(),p(F,null,[W(j(P(d))+" ",1),u("div",ue,[$(E,{class:"VTreeDemo",modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=e=>v.value=e),tree:P(d)},null,8,["modelValue","tree"]),$(E,{class:"VTreeDemo2",modelValue:y.value,"onUpdate:modelValue":n[1]||(n[1]=e=>y.value=e),tree:P(d)},{default:_(({model:e})=>[u("div",{class:"VTreeDemo2A",style:N({"--level":e.level})},[u("div",{class:"VTreeDemo2B",onClick:h=>e.open=!e.open},[e.children?(i(),p("i-feather",{key:0,i:e.open?"chevron-down":"chevron-right"},null,8,ie)):(i(),p("div",ve)),u("div",null,j(e.label??e.value),1)],8,de),u("i-feather",{class:"VTreeDemo2C",onClick:h=>e.selected=!e.selected,i:e.selected?"check-circle":"circle"},null,8,me)],4)]),_:1},8,["modelValue","tree"]),$(E,{class:"VTreeDemo3",modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=e=>m.value=e),tree:P(a)},{default:_(({model:e})=>[u("div",{class:"VTreeDemo3A",style:N({"--level":e.level})},[e.children?(i(),p("i-feather",{key:0,class:"VTreeDemo3B",onClick:h=>e.open=!e.open,i:e.open?"chevron-down":"chevron-right"},null,8,fe)):M("",!0),u("div",{class:"VTreeDemo3C",onClick:h=>e.selected=!e.selected},[u("div",null,j(e.label??e.value),1),u("i-feather",{i:e.selected?"check-circle":"circle"},null,8,pe)],8,he)],4)]),_:1},8,["modelValue","tree"]),$(E,{class:"VTreeDemo3",modelValue:f.value,"onUpdate:modelValue":n[3]||(n[3]=e=>f.value=e),tree:P(a),connected:""},{default:_(({model:e})=>[u("div",{class:"VTreeDemo3A",style:N({"--level":e.level})},[e.children?(i(),p("i-feather",{key:0,class:"VTreeDemo3B",onClick:h=>e.open=!e.open,i:e.open?"chevron-down":"chevron-right"},null,8,Ve)):M("",!0),u("div",{class:"VTreeDemo3C",onClick:h=>e.selected=!e.selected},[u("div",null,j(e.label??e.value),1),u("i-feather",{i:e.mixed?"square":e.selected?"check-circle":"circle"},null,8,ke)],8,ye)],4)]),_:1},8,["modelValue","tree"])])],64))}});export{be as default};
