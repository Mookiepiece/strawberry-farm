import{i as Y,B as ee}from"./theme.i3CGoA02.js";import{a4 as q,a5 as te,d as M,a6 as Z,o as f,i as y,r as C,a0 as se,a7 as D,x as p,I,t as L,k,a8 as ae,c as w,f as re,v as ne,G as oe,a9 as ie,$ as j,m as b,C as v,a as T,e as le,n as ce,b as N}from"./framework.IkYOgTiJ.js";import{T as ue}from"./Toast.sg7uKtJY.js";import{_ as me}from"./VButton.vue_vue_type_script_setup_true_lang.hipUyHXJ.js";import{_ as W}from"./VInput.vue_vue_type_script_setup_true_lang.j2rDQU0A.js";import{_ as de}from"./VRadioGroup.vue_vue_type_script_setup_true_lang.EWKGhJb3.js";import"./sf7.gX3VNmPo.js";import"./VListbox.vue_vue_type_script_setup_true_lang.hwwb5ZUb.js";const G=Symbol("VFormItemLabel"),J=Symbol("VForm");/**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 */const fe=(s,e)=>{const a=e.split(".");let t=s;for(const r of a)t=t==null?void 0:t[r];return t},pe=(s,e,a)=>{const t=e.split("."),r=t.slice(0,-1),i=t[t.length-1];let l=s;for(const c of r)if(l=l[c],!l)return;l[i]=a},he=(s,e)=>{const a=e.split("."),t=a.slice(0,-1),r=a[a.length-1];let i=s;for(const l of t)if(i=i[l],!i)return;delete i[r]},ye=(s,e)=>{let a=s,t={};const[r,i]=Array.isArray(e.action)?e.action:[e.action],l=q({value:a(),reset(c){c&&(a=c),l.value=a()},loading:!1,async submit(){l.loading=!0;try{const c=te(l.value);Object.entries(l.items).filter(([,u])=>!u._visible).forEach(([u])=>he(c,u));const h=await l.validate();if(typeof h=="string")throw i==null||i(h),new DOMException("","AbortError");return await(r==null?void 0:r(c))}finally{l.loading=!1}},_h:c=>{var _;let h=c.split("."),u=t;for(;h.length;){const d=h.shift();if(u=((_=u[d])==null?void 0:_.children)??u[d],!u)return{}}return u},i:c=>c,async validate(){var _;const c=Object.entries(l.items).filter(([,d])=>d._visible).map(([d,$])=>[d,$.validate()]),h=await Promise.all(c.map(([,d])=>d)),u=h.findIndex(d=>typeof d=="string");if(u!==-1){const d=c[u][0];return(_=l.items[d])==null||_.focus(),h[u]}},items:{},hierarchy:c=>void(t=c)});return l},P={inc:Y("FORM"),getter:fe,setter:pe,init:ye},_e=M({__name:"VForm",props:{form:{}},setup(s){const e=s;return Z(J,e.form),(a,t)=>(f(),y("form",{class:"VForm",onSubmit:t[0]||(t[0]=se(r=>void e.form.submit(),["prevent"]))},[C(a.$slots,"default")],32))}}),be=s=>{if(typeof s=="object"&&!Array.isArray(s))return s;const[e,a]=[Array.isArray(s)?s[0]:s,Array.isArray(s)?s[1]:void 0],t={type:e.endsWith("!")?e.slice(0,-1):e};return e.endsWith("!")&&(t.required=!0),a&&(t.config=a),t},ge={fieldname:"字段"},m={default:"{{s}} 不匹配格式",required:"请输入 {{s}}",checked:"请先检阅 {{s}}",enum:"{{s}} 不在选项范围内",any:"{{s}} 必须为任意类型",string:"{{s}} 必须为字符类型",array:"{{s}} 必须为列表类型",number:"{{s}} 必须为数值类型",boolean:"{{s}} 必须为布尔类型",email:"{{s}} 不是有效的邮箱地址",type:"{{s}} 不匹配格式",ranges:{string:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"},number:{len:"{{s}} 必须等于 {{a}}",min:"{{s}} 至少为 {{a}}",max:"{{s}} 至多为 {{a}}",range:"{{s}} 的值必须介于 {{a}} - {{b}}"},array:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"}}},A=/\{\{a\}\}/,O=/\{\{b\}\}/,S=/\{\{s\}\}/,z=(s,e,a)=>{if(typeof e=="number"&&s!==e)return m.ranges[a].len.replace(A,""+e);if(Array.isArray(e)){const[t,r]=e;if(typeof t=="number"&&s<t)return t===r?m.ranges[a].len.replace(A,""+t):typeof r=="number"?m.ranges[a].range.replace(A,""+t).replace(O,""+r):m.ranges[a].min.replace(A,""+t);if(typeof r=="number"&&s>r)return t===r?m.ranges[a].len.replace(A,""+t):typeof t=="number"?m.ranges[a].range.replace(A,""+t).replace(O,""+r):m.ranges[a].max.replace(A,""+r)}},g=new Map;g.set("any",{type:()=>{}});g.set("string",{type:(s,e)=>{if(typeof s!="string")return m.string;if(typeof e=="number"||Array.isArray(e))return z(s.length,e,"string");if(e instanceof RegExp&&!e.test(s))return m.default},testEmpty:s=>s===""});g.set("number",{type:(s,e)=>{if(typeof s!="number"||!Number.isFinite(s)||Number.isNaN(s))return m.number;if(typeof e=="number"||Array.isArray(e))return z(s,e,"number")}});g.set("array",{type:(s,e)=>{if(!Array.isArray(s))return m.array;if(typeof e=="number"||Array.isArray(e))return z(s.length,e,"array")}});g.set("enum",{type:(s,e)=>{if(!(Array.isArray(e)?e:[e]).some(t=>Object.is(s,t)))return m.enum}});g.set("boolean",{type:s=>{if(typeof s!="boolean")return m.boolean}});g.set("checked",{type:s=>{if(s!==!0)return m.checked}});g.set("type",{type:(s,e)=>{if(e&&s&&!(s instanceof e))return m.default}});const ve=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;g.set("email",{extends:"string",type(s){if(!ve.test(s))return m.email}});const we=s=>s==null,U=(s,e,a=ge.fieldname)=>{var c,h,u;const t=be(e),r=t.type&&g.get(t.type);if(r!=null&&r.extends){const _=U(s,{...t,type:r.extends},a);if(_)return _}const i=we(s)||((c=r==null?void 0:r.testEmpty)==null?void 0:c.call(r,s,t.config));if(!t.required&&i)return;if(t.required&&i)return t.message??m.required.replace(S,a);const l=(h=r==null?void 0:r.type)==null?void 0:h.call(r,s,t.config);return typeof l=="string"?t.message??l.replace(S,a):(u=t.validator)==null?void 0:u.call(t,s)},Ae=["for"],ke={key:0,class:"clr-main"},H=M({__name:"VFormLabel",setup(s){const{id:e,label:a,asterisk:t}=D(G)||{},r=()=>{var i;return(i=document.getElementById(e))==null?void 0:i.focus()};return(i,l)=>p(e)&&p(a)?(f(),y("label",{key:0,for:p(e),tabindex:"-1",onFocus:r},[I(L(p(a))+" ",1),p(t)?(f(),y("span",ke,"*")):k("",!0)],40,Ae)):k("",!0)}}),$e={class:"VFormItemTitle"},xe={key:0,class:"f3"},Ee={key:1},Ne={key:2,class:"[B] f2 tone:reimu Alert"},Ve=b("i-feather",{i:"x-octagon"},null,-1),Fe={class:"px-1"},V=M({__name:"VFormItem",props:{name:{},label:{}},setup(s){const e=s,a=ae(),t=D(J),r=P.inc(),i=w(()=>e.name?t._h(e.name):void 0),l=w(()=>{var n;return p((n=i.value)==null?void 0:n.label)??e.label}),c=w(()=>{var n;return p((n=i.value)==null?void 0:n.rules)}),h=w(()=>{var n;return!!((n=c.value)!=null&&n.some(o=>typeof o=="string"?o.endsWith("!"):Array.isArray(o)?o[0].endsWith("!"):o.required))}),u=w(()=>{var n,o;return((o=(n=i.value)==null?void 0:n.visible)==null?void 0:o.value)!==!1});Z(G,q({id:r,label:l,asterisk:h}));const _=w({get(){if(e.name)return P.getter(t.value,e.name)},set(n){e.name&&(P.setter(t.value,e.name,n),K().then(o=>R.message=o))}}),d=async()=>{const n=_.value,o=c.value,B=l.value;if(o){let E;for(const X of o)if(E=await U(n,X,B),typeof E=="string")return E}},$=ee(),K=async()=>{$();const n=$(new AbortController).signal,o=await d();return n.aborted?new Promise(()=>1/0):o},F=re(),R=q({focus:()=>{var n,o;return(o=(n=F.value.el??F.value.$el??F.value)==null?void 0:n.focus)==null?void 0:o.call(n)},validate:()=>($(),d()),_visible:u.value,message:void 0});ne(u,n=>R._visible=n,{immediate:!0}),oe(n=>{const o=e.name;!o||!i.value||(t.items[o]=R,n(()=>delete t.items[o]))});const x=w(()=>R.message),Q=w(()=>{var n,o,B;return ie(((n=a.default)==null?void 0:n.call(a)[0])??((B=p((o=i.value)==null?void 0:o.render))==null?void 0:B())??j(W),{modelValue:_.value,"onUpdate:modelValue":E=>{_.value=E}})});return(n,o)=>n.name&&i.value&&u.value?(f(),y("div",{key:0,class:ce(["VFormItem",{invalid:typeof x.value=="string"}])},[b("div",$e,[C(n.$slots,"title",{},()=>[v(H)])]),(f(),T(le(Q.value),{name:n.name,ref_key:"input",ref:F},null,8,["name"])),n.$slots.extra?(f(),y("div",xe,[C(n.$slots,"extra")])):k("",!0),n.$slots.alert?(f(),y("div",Ee,[x.value?C(n.$slots,"alert",{key:0,message:x.value}):k("",!0)])):x.value?(f(),y("div",Ne,[Ve,b("div",Fe,L(x.value),1)])):k("",!0)],2)):k("",!0)}}),Re={class:"[B] gap-1"},Be=b("i-feather",{i:"arrow-right-circle"},null,-1),Ce={class:"[A]"},Ie={class:"[B] gap-1"},Pe={key:0,i:"x",class:"clr-main tone:reimu"},Me={key:1,i:"check",class:"clr-1"},qe={class:"[B] gap-1"},ze={key:0,i:"x",class:"clr-main tone:reimu"},Oe={key:1,i:"check",class:"clr-1"},Se={class:"[B] gap-1"},Ze={key:0,i:"x",class:"clr-main tone:reimu"},De={key:1,i:"check",class:"clr-1"},Le=b("i-feather",{i:"message-circle"},null,-1),Xe=M({__name:"FormSignup",setup(s){const e=P.init(()=>({name:"霧雨魔理沙",password:"",repeatPassword:"",phoneNumber:"",dateRange:[new Date,new Date],chara:{name:"",weapon:"",shot:"",spellCard:""},charas:[]}),{action:t=>{ue.success(JSON.stringify(t,null,2))}});e.hierarchy({name:{label:"Name",rules:[{type:"string",required:!0,config:[3,10]}]},password:{label:"Password",rules:[{validator(t){if(t.includes(" ")||t.length<6||t.length>12||t==="123456")return""}}]},dateRange:{},phoneNumber:{label:"Phone"},repeatPassword:{label:"Repeat Password",rules:[{validator(t){if(t!==e.value.password)return"Passwords are not equal"}}]},chara:{children:{name:{label:"Character",render(){return j(de,{options:["博麗霊夢","霧雨魔理沙"]})}},shot:{},spellCard:{},weapon:{}}},charaDel:{},charas:{init(){return{name:"",shot:"",spellCard:"",weapon:""}},children:{children:{name:{},shot:{},spellCard:{},weapon:{}}}}});const a=e.value;return e.items.name,e.items["dateRange.0"],e.items["charas.0.name"],(t,r)=>(f(),T(_e,{form:p(e)},{default:N(()=>[v(V,{name:p(e).i("name")},{title:N(()=>[b("div",Re,[v(H),Be])]),_:1},8,["name"]),v(V,{name:p(e).i("password")},{extra:N(()=>[b("div",Ce,[b("div",Ie,[p(a).password.includes(" ")?(f(),y("i-feather",Pe)):(f(),y("i-feather",Me)),I(" Password cannot contain spaces. ")]),b("div",qe,[p(a).password.length<6||p(a).password.length>12?(f(),y("i-feather",ze)):(f(),y("i-feather",Oe)),I(" Password should between 6 - 12 characters. ")]),b("div",Se,[p(a).password==="123456"?(f(),y("i-feather",Ze)):(f(),y("i-feather",De)),I(" Password cannot be 123456 because that's the admin's password. ")])])]),_:1},8,["name"]),v(V,{name:"repeatPassword"}),v(V,{name:"phoneNumber"},{default:N(()=>[v(W,{placehholder:"666",clearable:""})]),_:1}),v(V,{name:"chara.name"},null,8,["name"]),v(me,{type:"submit",class:"mat:air"},{prefix:N(()=>[Le]),_:1})]),_:1},8,["form"]))}});export{Xe as default};
