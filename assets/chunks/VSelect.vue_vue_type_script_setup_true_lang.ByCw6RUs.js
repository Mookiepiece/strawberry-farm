import{f as $,G as b,v as I,d as T,z as M,A as E,c,o as p,i as y,m as V,r as B,k as w,n as K,t as N,aa as z,a0 as D,a1 as f,x as k,a as F,ac as j,ad as q,C as G,T as H,F as O}from"./framework.IAuM8QuA.js";import{o as U,l as C,f as P,b as W,s as J,a as L,d as Q,m as R}from"./theme.DZqSg4PV.js";import{f as X}from"./misc.C9Tk6PVQ.js";import{_ as Y}from"./VListbox.vue_vue_type_script_setup_true_lang.B1_CvdMk.js";const Z=(v,o)=>{const e=Array.isArray(v)?v:[v];return U(document).pointerdown(d=>{e.every(l=>(l==null?void 0:l.contains(d.target))===!1)&&o()})},_=({reference:v,popper:o,configs:e,plugins:d=[]})=>{const l=$(!1),u=$(!1);return b(n=>{const[s,i,m]=[l.value,v.value,o.value];s&&m&&i&&n(C.auto(i,()=>{C(i,m,e,...d),u.value=!0}))}),I(()=>[e==null?void 0:e.trap,l.value,u.value,o.value],(n,s,i)=>{e!=null&&e.trap&&(!l.value||!u.value||!o.value||i(W(o.value)))}),b(n=>{if(!(e!=null&&e.clickAway)||!l.value)return;const[s,i]=[v.value,o.value];!s||!i||n(Z([i,s],()=>l.value=!1))}),b(()=>{if(!u.value||!o.value)return;if(!(e!=null&&e.animated)){l.value||(u.value=!1);return}const n=o.value.querySelector(".VPopperBody");n&&(l.value?P.cssTransition(n,"v-enter"):P.cssTransition(n,"v-leave",{done(){u.value=!1}}))}),{open:l,visible:u}},g=["aria-expanded"],ee={key:0,class:"VInputPrefix"},ae={key:1,class:"VInputSuffix"},le={class:"VPopperBody"},oe=T({__name:"VSelect",props:M({options:{},disabled:{type:Boolean},placeholder:{},clearable:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v,{expose:o}){const e=E(v,"modelValue"),d=v,l=c(()=>Array.isArray(e.value)),u=$(),n=$(),{open:s,visible:i}=_({popper:n,reference:u,configs:{offset:5,animated:!0,trap:!0,clickAway:!0},plugins:[J,L(()=>({limit:200})),Q,R]}),m=()=>{var a;l.value?(e.value.splice(0,e.value.length),e.value=e.value):e.value=null,(a=u.value)==null||a.focus()},x=c({get(){return e.value},set(a){l.value||(s.value=!1),e.value=a}}),S=c(()=>{var t;if(!d.options)return e.value;const a=X(d.options);return l.value?a.filter(r=>{var h;return(h=e.value)==null?void 0:h.includes(r.value)}).map(r=>r.label).join(", "):(t=a.find(r=>r.value===e.value))==null?void 0:t.label}),A=c(()=>{var a;return l.value?!((a=e.value)!=null&&a.length):e.value==null});return o({el:u}),(a,t)=>(p(),y(O,null,[V("div",z({class:"VInput VSelect",tabindex:"0",ref_key:"reference",ref:u,onClick:t[0]||(t[0]=D(r=>s.value=!k(s),["self"])),onKeydown:[t[1]||(t[1]=f(r=>s.value=!0,["space"])),t[2]||(t[2]=f(r=>s.value=!0,["enter"])),t[3]||(t[3]=f(r=>s.value=!0,["up"])),t[4]||(t[4]=f(r=>s.value=!0,["down"]))],role:"button","aria-haspopup":"true","aria-expanded":k(s)},a.$attrs),[a.$slots.prefix?(p(),y("div",ee,[B(a.$slots,"prefix")])):w("",!0),a.$slots.suffix?(p(),y("div",ae,[B(a.$slots,"suffix")])):w("",!0),a.clearable&&!a.disabled&&!A.value?(p(),y("i-feather",{key:2,i:"x",class:"VInputEraser",tabindex:"-1",onClick:m,"aria-hidden":"true"})):w("",!0),V("div",{class:K(["VInputTrunk",A.value?"VInputTrunkPlaceholder":void 0])},N(S.value??a.placeholder),3)],16,g),(p(),F(H,{to:"body"},[j(V("div",{ref_key:"popper",ref:n,class:"VPositioner",onKeydown:t[6]||(t[6]=f(r=>s.value=!1,["esc"])),style:{position:"fixed",top:"0",left:"0"}},[V("div",le,[G(Y,{multi:l.value,magnetic:"",modelValue:x.value,"onUpdate:modelValue":t[5]||(t[5]=r=>x.value=r),options:a.options,class:"VSelectPicker"},null,8,["multi","modelValue","options"])])],544),[[q,k(s)||k(i)]])]))],64))}});export{oe as _};
