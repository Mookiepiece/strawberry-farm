import{i as X,B as Y}from"./theme.CGULKHWn.js";import{_ as ee}from"./VRadios.vue_vue_type_script_setup_true_lang.CO0MKLzo.js";import"./VSelect.vue_vue_type_style_index_0_lang.BEOdSXfJ.js";import{a0 as M,ad as te,d as P,ae as S,o as f,j as h,r as B,a2 as se,af as Z,y as p,H as R,t as D,l as k,a1 as re,c as w,E as ae,p as b,a as j,e as ne,n as oe,D as v,a3 as ie,Z as L,b as N}from"./framework.qiMOmzvi.js";import{T as le}from"./Toast.ByqmDY5X.js";import{_ as ce}from"./VButton.vue_vue_type_script_setup_true_lang.CUt_uMUw.js";import{_ as T}from"./VInput.vue_vue_type_script_setup_true_lang.C-NXLSu3.js";import"./VListbox.vue_vue_type_script_setup_true_lang.CoV8QZP8.js";import"./nav.CPGBmk_S.js";import"./sf7.2qo0E3J-.js";const W=Symbol("VFormItemLabel"),H=Symbol("VForm");/**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 *//**
 * @license MIT react-hook-form
 */const me=(s,e)=>{const a=e.split(".");let t=s;for(const r of a)t=t==null?void 0:t[r];return t},ue=(s,e,a)=>{const t=e.split("."),r=t.slice(0,-1),c=t[t.length-1];let i=s;for(const l of r)if(i=i[l],!i)return;i[c]=a},de=(s,e)=>{const a=e.split("."),t=a.slice(0,-1),r=a[a.length-1];let c=s;for(const i of t)if(c=c[i],!c)return;delete c[r]},fe=(s,e)=>{let a=s,t={};const[r,c]=Array.isArray(e.action)?e.action:[e.action],i=M({value:a(),reset(l){l&&(a=l),i.value=a()},loading:!1,async submit(){i.loading=!0;try{const l=te(i.value);Object.entries(i.items).filter(([,m])=>!m._visible).forEach(([m])=>de(l,m));const y=await i.validate();if(typeof y=="string")throw c==null||c(y),new DOMException("","AbortError");return await(r==null?void 0:r(l))}finally{i.loading=!1}},_h:l=>{var _;let y=l.split("."),m=t;for(;y.length;){const d=y.shift();if(m=((_=m[d])==null?void 0:_.children)??m[d],!m)return{}}return m},i:l=>l,async validate(){var _;const l=Object.entries(i.items).filter(([,d])=>d._visible).map(([d,$])=>[d,$.validate()]),y=await Promise.all(l.map(([,d])=>d)),m=y.findIndex(d=>typeof d=="string");if(m!==-1){const d=l[m][0];return(_=i.items[d])==null||_.focus(),y[m]}},items:{},hierarchy:l=>void(t=l)});return i},I={inc:X("FORM"),getter:me,setter:ue,init:fe},pe=P({__name:"VForm",props:{form:{}},setup(s){const e=s;return S(H,e.form),(a,t)=>(f(),h("form",{class:"VForm",onSubmit:t[0]||(t[0]=se(r=>void e.form.submit(),["prevent"]))},[B(a.$slots,"default")],32))}}),ye=s=>{if(typeof s=="object"&&!Array.isArray(s))return s;const[e,a]=[Array.isArray(s)?s[0]:s,Array.isArray(s)?s[1]:void 0],t={type:e.endsWith("!")?e.slice(0,-1):e};return e.endsWith("!")&&(t.required=!0),a&&(t.config=a),t},he={fieldname:"字段"},u={default:"{{s}} 不匹配格式",required:"请输入 {{s}}",checked:"请先检阅 {{s}}",enum:"{{s}} 不在选项范围内",any:"{{s}} 必须为任意类型",string:"{{s}} 必须为字符类型",array:"{{s}} 必须为列表类型",number:"{{s}} 必须为数值类型",boolean:"{{s}} 必须为布尔类型",email:"{{s}} 不是有效的邮箱地址",type:"{{s}} 不匹配格式",ranges:{string:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"},number:{len:"{{s}} 必须等于 {{a}}",min:"{{s}} 至少为 {{a}}",max:"{{s}} 至多为 {{a}}",range:"{{s}} 的值必须介于 {{a}} - {{b}}"},array:{len:"{{s}} 的长度必须等于 {{a}}",min:"{{s}} 的长度至少为 {{a}}",max:"{{s}} 的长度至多为 {{a}}",range:"{{s}} 的长度必须介于 {{a}} - {{b}}"}}},A=/\{\{a\}\}/,z=/\{\{b\}\}/,O=/\{\{s\}\}/,q=(s,e,a)=>{if(typeof e=="number"&&s!==e)return u.ranges[a].len.replace(A,""+e);if(Array.isArray(e)){const[t,r]=e;if(typeof t=="number"&&s<t)return t===r?u.ranges[a].len.replace(A,""+t):typeof r=="number"?u.ranges[a].range.replace(A,""+t).replace(z,""+r):u.ranges[a].min.replace(A,""+t);if(typeof r=="number"&&s>r)return t===r?u.ranges[a].len.replace(A,""+t):typeof t=="number"?u.ranges[a].range.replace(A,""+t).replace(z,""+r):u.ranges[a].max.replace(A,""+r)}},g=new Map;g.set("any",{type:()=>{}});g.set("string",{type:(s,e)=>{if(typeof s!="string")return u.string;if(typeof e=="number"||Array.isArray(e))return q(s.length,e,"string");if(e instanceof RegExp&&!e.test(s))return u.default},testEmpty:s=>s===""});g.set("number",{type:(s,e)=>{if(typeof s!="number"||!Number.isFinite(s)||Number.isNaN(s))return u.number;if(typeof e=="number"||Array.isArray(e))return q(s,e,"number")}});g.set("array",{type:(s,e)=>{if(!Array.isArray(s))return u.array;if(typeof e=="number"||Array.isArray(e))return q(s.length,e,"array")}});g.set("enum",{type:(s,e)=>{if(!(Array.isArray(e)?e:[e]).some(t=>Object.is(s,t)))return u.enum}});g.set("boolean",{type:s=>{if(typeof s!="boolean")return u.boolean}});g.set("checked",{type:s=>{if(s!==!0)return u.checked}});g.set("type",{type:(s,e)=>{if(e&&s&&!(s instanceof e))return u.default}});const _e=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;g.set("email",{extends:"string",type(s){if(!_e.test(s))return u.email}});const be=s=>s==null,J=(s,e,a=he.fieldname)=>{var l,y,m;const t=ye(e),r=t.type&&g.get(t.type);if(r!=null&&r.extends){const _=J(s,{...t,type:r.extends},a);if(_)return _}const c=be(s)||((l=r==null?void 0:r.testEmpty)==null?void 0:l.call(r,s,t.config));if(!t.required&&c)return;if(t.required&&c)return t.message??u.required.replace(O,a);const i=(y=r==null?void 0:r.type)==null?void 0:y.call(r,s,t.config);return typeof i=="string"?t.message??i.replace(O,a):(m=t.validator)==null?void 0:m.call(t,s)},ge=["for"],ve={key:0,class:"clr-main"},U=P({__name:"VFormLabel",setup(s){const e=Z(W)||{id:"",asterisk:!1},a=()=>{var t;return(t=document.getElementById(e.id))==null?void 0:t.focus()};return(t,r)=>p(e).id&&p(e).label?(f(),h("label",{key:0,for:p(e).id,tabindex:"-1",onFocus:a},[R(D(p(e).label)+" ",1),p(e).asterisk?(f(),h("span",ve,"*")):k("",!0)],40,ge)):k("",!0)}}),we={class:"VFormItemTitle"},Ae={key:0,class:"f3"},ke={key:1},$e={key:2,class:"[B] f2 tone:reimu Alert"},xe={class:"px-1"},V=P({__name:"VFormItem",props:{name:{},label:{},rules:{},visible:{type:Boolean,default:void 0}},setup(s){const e=s,a=re(),t=Z(H),r=I.inc(),c=w(()=>e.name?t._h(e.name):void 0),i=w(()=>{var n;return p((n=c.value)==null?void 0:n.label)??e.label}),l=w(()=>{var n;return[...p((n=c.value)==null?void 0:n.rules)??[],...e.rules??[]]}),y=w(()=>{var n;return!!((n=l.value)!=null&&n.some(o=>typeof o=="string"?o.endsWith("!"):Array.isArray(o)?o[0].endsWith("!"):o.required))}),m=w(()=>{var n,o;return typeof e.visible=="boolean"?e.visible:((o=(n=c.value)==null?void 0:n.visible)==null?void 0:o.value)!==!1});S(W,M({id:r,label:i,asterisk:y}));const _=w({get(){if(e.name)return I.getter(t.value,e.name)},set(n){e.name&&(I.setter(t.value,e.name,n),G().then(o=>C.message=o))}}),d=async()=>{const n=_.value,o=l.value,F=i.value;if(o.length){let E;for(const Q of o)if(E=await J(n,Q,F),typeof E=="string")return E}},$=Y(),G=async()=>{$();const n=$(new AbortController).signal,o=await d();return n.aborted?new Promise(()=>1/0):o},C=M({focus:()=>{var n,o;return(o=(n=document.getElementById(r))==null?void 0:n.focus)==null?void 0:o.call(n)},validate:()=>($(),d()),_visible:m,message:void 0});ae(n=>{const o=e.name;!o||!c.value||(t.items[o]=C,n(()=>delete t.items[o]))});const x=w(()=>C.message),K=()=>{var n,o,F;return ie(((n=a.default)==null?void 0:n.call(a)[0])??((F=(o=c.value)==null?void 0:o.render)==null?void 0:F.call(o))??L(T),{id:r,modelValue:_.value,"onUpdate:modelValue":E=>{_.value=E}})};return(n,o)=>n.name&&m.value?(f(),h("div",{key:0,class:oe(["VFormItem",{invalid:typeof x.value=="string"}])},[b("div",we,[B(n.$slots,"title",{},()=>[v(U)])]),(f(),j(ne(K))),n.$slots.extra?(f(),h("div",Ae,[B(n.$slots,"extra")])):k("",!0),n.$slots.alert?(f(),h("div",ke,[x.value?B(n.$slots,"alert",{key:0,message:x.value}):k("",!0)])):x.value?(f(),h("div",$e,[o[0]||(o[0]=b("i-feather",{i:"x-octagon"},null,-1)),b("div",xe,D(x.value),1)])):k("",!0)],2)):k("",!0)}}),Ee={class:"[B] gap-1"},Ne={class:"[A]"},Ve={class:"[B] gap-1"},Fe={key:0,i:"x",class:"clr-main tone:reimu"},Be={key:1,i:"check",class:"clr-1"},Re={class:"[B] gap-1"},Ie={key:0,i:"x",class:"clr-main tone:reimu"},Pe={key:1,i:"check",class:"clr-1"},Ce={class:"[B] gap-1"},Me={key:0,i:"x",class:"clr-main tone:reimu"},qe={key:1,i:"check",class:"clr-1"},Ue=P({__name:"FormSignup",setup(s){const e=I.init(()=>({name:"霧雨魔理沙",password:"",repeatPassword:"",phoneNumber:"",dateRange:[new Date,new Date],chara:{name:"",weapon:"",shot:"",spellCard:""},charas:[]}),{action:t=>{le.success(JSON.stringify(t,null,2))}});e.hierarchy({name:{label:"Name",rules:[{type:"string",required:!0,config:[3,10]}]},password:{label:"Password",rules:[{validator(t){if(t.includes(" ")||t.length<6||t.length>12||t==="123456")return""}}]},dateRange:{},phoneNumber:{label:"Phone"},repeatPassword:{label:"Repeat Password",rules:[{validator(t){if(t!==e.value.password)return"Passwords are not equal"}}]},chara:{children:{name:{label:"Character",render(){return L(ee,{options:["博麗霊夢","霧雨魔理沙"]})}},shot:{},spellCard:{},weapon:{}}},charaDel:{},charas:{init(){return{name:"",shot:"",spellCard:"",weapon:""}},children:{children:{name:{},shot:{},spellCard:{},weapon:{}}}}});const a=e.value;return e.items.name,e.items["dateRange.0"],e.items["charas.0.name"],(t,r)=>(f(),j(pe,{form:p(e)},{default:N(()=>[v(V,{name:p(e).i("name")},{title:N(()=>[b("div",Ee,[v(U),r[0]||(r[0]=b("i-feather",{i:"arrow-right-circle"},null,-1))])]),_:1},8,["name"]),v(V,{name:p(e).i("password")},{extra:N(()=>[b("div",Ne,[b("div",Ve,[p(a).password.includes(" ")?(f(),h("i-feather",Fe)):(f(),h("i-feather",Be)),r[1]||(r[1]=R(" Password cannot contain spaces. "))]),b("div",Re,[p(a).password.length<6||p(a).password.length>12?(f(),h("i-feather",Ie)):(f(),h("i-feather",Pe)),r[2]||(r[2]=R(" Password should between 6 - 12 characters. "))]),b("div",Ce,[p(a).password==="123456"?(f(),h("i-feather",Me)):(f(),h("i-feather",qe)),r[3]||(r[3]=R(" Password cannot be 123456 because that's the admin's password. "))])])]),_:1},8,["name"]),v(V,{name:"repeatPassword"}),v(V,{name:"phoneNumber"},{default:N(()=>[v(T,{placehholder:"666",clearable:""})]),_:1}),v(V,{name:"chara.name"}),v(ce,{type:"submit",class:"mat:air"},{prefix:N(()=>r[4]||(r[4]=[b("i-feather",{i:"send"},null,-1)])),_:1})]),_:1},8,["form"]))}});export{Ue as default};
